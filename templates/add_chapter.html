{% extends "base.html" %}

{% block content %}
    <div class="col-md-8 offset-md-2 mt-3">
        <h2 class="text-center mb-4">添加新章节</h2>
        <form method="POST" action="{{ url_for('add_chapter') }}" enctype="multipart/form-data">
            <div class="mb-3">
                <label for="title" class="form-label">章节标题</label>
                <input type="text" class="form-control" id="title" name="title" required>
            </div>
            <div class="mb-3">
                <label for="original_text" class="form-label">原文内容</label>
                <textarea id="original_text" name="original_text" required></textarea>
            </div>
            <div class="mb-3">
                <label for="translation" class="form-label">译文内容</label>
                <textarea id="translation" name="translation" required></textarea>
            </div>
            <div class="mb-3">
                <label for="annotations" class="form-label">注释内容</label>
                <textarea id="annotations" name="annotations"></textarea>
            </div>
            <script src="https://cdn.jsdelivr.net/npm/tinymce@6.7.0/tinymce.min.js"></script>
            <script>
                tinymce.init({
                    selector: 'textarea',
                    plugins: 'image code link lists media',
                    toolbar: 'undo redo | styleselect | bold italic | alignleft aligncenter alignright | bullist numlist | link image media',
                    height: 500,
                    images_upload_url: '/upload_image',
                    automatic_uploads: true
                });
            </script>
            <div class="mb-3">
                <label for="image" class="form-label">相关图片</label>
                <input type="file" class="form-control" id="image" name="image">
            </div>
            <button type="submit" class="btn btn-primary w-100" onclick="return validateForm()">提交</button>
<script>
function validateForm() {
    // 确保所有必填字段都有内容
    if(tinymce.get('original_text').getContent() === '' || 
       tinymce.get('translation').getContent() === '') {
        alert('请填写所有必填字段');
        return false;
    }
    return true;
}
</script>
        </form>
    </div>
{% endblock %}